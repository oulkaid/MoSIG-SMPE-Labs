#+TITLE: Automating dataframe construction starting from copy/past from a .pdf
#+AUTHOR: Oussama Oulkaid
#+OPTIONS: toc:nil

* Starting point
After copying/pasting the table from the .pdf file, we attach the labels (using "_") so that the delimiter become a single space (" "). 
We also insert a row on the top of the file ; first step to approprieatly read the .csv file.

#+BEGIN_src R
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
#+END_src 

* Build the Dataframe from file

#+BEGIN_src R :exports both :results output
Group1 <- read_delim("DATA1_copyPast.csv",delim ="\n")
Group2 <- read_delim("DATA2_copyPast.csv",delim ="\n")
#+END_src 

#+RESULTS:

* Arrange the Dataframe
+ petite section : *PS*
+ moyenne section : *MS*
+ grande section : *GS*

#+BEGIN_src R
# GROUP 1

PS_1_indexes <- seq(1,nrow(Group1),3)
MS_1_indexes <- seq(2,nrow(Group1),3)
GS_1_indexes <- seq(3,nrow(Group1),3)

PS_1 <- strsplit( data.frame(x=Group1[PS_1_indexes,])[,] , " " )
MS_1 <- strsplit( data.frame(x=Group1[MS_1_indexes,])[,] , " " )
GS_1 <- strsplit( data.frame(x=Group1[GS_1_indexes,])[,] , " " )

df_Id_1 <- data.frame(matrix(unlist(1), nrow=33, byrow=TRUE))
df_PS_1 <- data.frame(matrix(unlist(PS_1), nrow=33+1, byrow=TRUE))
df_MS_1 <- data.frame(matrix(unlist(MS_1), nrow=33+1, byrow=TRUE))
df_GS_1 <- data.frame(matrix(unlist(GS_1), nrow=33+1, byrow=TRUE))

names(df_Id_1)[1] <- "group_Id"
names(df_PS_1)[1] <- "score_PS"
names(df_MS_1)[1] <- "score_MS"
names(df_GS_1)[1] <- "score_GS"

df_PS_1 <- subset(df_PS_1,score_PS!="score_in_petite_section")
df_MS_1 <- subset(df_MS_1,score_MS!="score_in_moyenne_section")
df_GS_1 <- subset(df_GS_1,score_GS!="score_in_grande_section")

# GROUP 2

PS_2_indexes <- seq(1,nrow(Group2),3)
MS_2_indexes <- seq(2,nrow(Group2),3)
GS_2_indexes <- seq(3,nrow(Group2),3)

PS_2 <- strsplit( data.frame(x=Group2[PS_2_indexes,])[,] , " " )
MS_2 <- strsplit( data.frame(x=Group2[MS_2_indexes,])[,] , " " )
GS_2 <- strsplit( data.frame(x=Group2[GS_2_indexes,])[,] , " " )

df_Id_2 <- data.frame(matrix(unlist(2), nrow=30, byrow=TRUE))
df_PS_2 <- data.frame(matrix(unlist(PS_2), nrow=30+1, byrow=TRUE))
df_MS_2 <- data.frame(matrix(unlist(MS_2), nrow=30+1, byrow=TRUE))
df_GS_2 <- data.frame(matrix(unlist(GS_2), nrow=30+1, byrow=TRUE))

names(df_Id_2)[1] <- "group_Id"
names(df_PS_2)[1] <- "score_PS"
names(df_MS_2)[1] <- "score_MS"
names(df_GS_2)[1] <- "score_GS"

df_PS_2 <- subset(df_PS_2,score_PS!="score_in_petite_section")
df_MS_2 <- subset(df_MS_2,score_MS!="score_in_moyenne_section")
df_GS_2 <- subset(df_GS_2,score_GS!="score_in_grande_section")

# Constructing the Dataframe 

df_Id <- rbind(df_Id_1, df_Id_2)
df_PS <- rbind(df_PS_1, df_PS_2)
df_MS <- rbind(df_MS_1, df_MS_2)
df_GS <- rbind(df_GS_1, df_GS_2)

df <- cbind(df_Id, df_PS, df_MS, df_GS)

df <- apply(apply(df, 2, gsub, patt=",", replace="."), 2, as.numeric)

df <- transform( df, score_PS = as.numeric(as.character(score_PS)), score_MS = as.numeric(as.character(score_MS)), 
                 score_GS = as.numeric(as.character(score_GS)) )

df
#+END_src

Finally,  we got a dataframe with the following format : 

| group_Id | score_PS | score_MS | score_GS |
| <dbl>    | <dbl>    | <dbl>    | <dbl>    |
|          |          |          |          |
